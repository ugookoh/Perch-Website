{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport firebase from 'firebase';\nimport React from 'react';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { AiOutlineCheck } from 'react-icons/ai';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport { validateVehicle, dateOfQuery, colors } from '../../functions';\nimport styles from '../panel_layout.module.css';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default class VehicleApplications extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"loadResult\", () => {\n      if (this.state.userDetails) {\n        firebase.database().ref(`vehicleAdditionRequest`).once('value', snapshot => {\n          this.setState({\n            result: snapshot.val() ? snapshot.val() : {}\n          });\n        });\n      }\n    });\n\n    _defineProperty(this, \"loadDocument\", (userID, documentStorageID) => {\n      firebase.storage().ref(`driverVehicleDocs/${userID}/${documentStorageID}/vehicleRegistration`).getDownloadURL().then(result => {\n        this.setState({\n          docRegistrationURL: result\n        });\n      }).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`driverVehicleDocs/${userID}/${documentStorageID}/vehicleInsurance`).getDownloadURL().then(result => {\n        this.setState({\n          docInsuranceURL: result\n        });\n      }).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`driverVehicleDocs/${userID}/${documentStorageID}/vehicleInspection`).getDownloadURL().then(result => {\n        this.setState({\n          docInspectionURL: result\n        });\n      }).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`driverVehicleDocs/${userID}/${documentStorageID}/vehicleImage`).getDownloadURL().then(result => {\n        this.setState({\n          docVehicleImage: result\n        });\n      }).catch(error => {\n        console.log(error.message);\n      });\n    });\n\n    this.state = {\n      showDocs: false,\n      result: {},\n      docList: [\"Vehicle insurance\", \"Vehicle registration\", \"Vehicle inspection\"],\n      selected: {},\n      docRegistrationURL: '',\n      docInsuranceURL: '',\n      docInspectionURL: '',\n      docVehicleImage: '',\n      inspectionVerified: false,\n      registrationVerified: false,\n      insuranceVerified: false,\n      urlToShow: null\n    };\n  }\n\n  componentDidMount() {\n    this.loadResult();\n  }\n\n  render() {\n    let requirements = [];\n\n    for (let i = 0; i < this.state.docList.length; i++) {\n      let urlToShow = '';\n      if (this.state.docList[i] == 'Vehicle insurance') urlToShow = this.state.docInsuranceURL;else if (this.state.docList[i] == 'Vehicle registration') urlToShow = this.state.docRegistrationURL;else if (this.state.docList[i] == 'Vehicle inspection') urlToShow = this.state.docInspectionURL;\n      let isVerified = false;\n      if (this.state.docList[i] == 'Vehicle insurance') isVerified = this.state.insuranceVerified;else if (this.state.docList[i] == 'Vehicle registration') isVerified = this.state.registrationVerified;else if (this.state.docList[i] == 'Vehicle inspection') isVerified = this.state.inspectionVerified;\n      requirements.push( /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.driverFAQ_PICDESC,\n        id: styles.driverROUNDSUPPORT,\n        children: [/*#__PURE__*/_jsx(\"a\", {\n          href: urlToShow,\n          target: '_blank',\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: styles.text,\n            style: {\n              color: '#000000',\n              width: 'initial',\n              margin: '0px',\n              marginLeft: '10px'\n            },\n            children: this.state.docList[i]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.driver_APP_RADIO,\n          style: {\n            backgroundColor: colors.GREEN,\n            opacity: isVerified ? 1 : 0.5\n          },\n          onClick: () => {\n            if (this.state.docList[i] == 'Vehicle insurance') this.setState({\n              insuranceVerified: true\n            });else if (this.state.docList[i] == 'Vehicle registration') this.setState({\n              registrationVerified: true\n            });else if (this.state.docList[i] == 'Vehicle inspection') this.setState({\n              inspectionVerified: true\n            });\n          },\n          children: isVerified ? /*#__PURE__*/_jsx(AiOutlineCheck, {\n            color: colors.WHITE,\n            size: '15px'\n          }) : /*#__PURE__*/_jsx(_Fragment, {})\n        })]\n      }));\n    }\n\n    if (!this.state.userDetails && this.props.userDetails) this.setState({\n      userDetails: this.props.userDetails\n    }, () => {\n      this.loadResult();\n    });\n    let results = [];\n    const keys = Object.keys(this.state.result).sort();\n\n    for (let k = 0; k < keys.length; k++) {\n      const {\n        year,\n        make,\n        model,\n        timestamp,\n        userID,\n        documentStorageID\n      } = this.state.result[keys[k]];\n      const carName = `${year} ${make} ${model}`;\n      results.push( /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: styles.previousMessageSum,\n          onClick: () => {\n            this.loadDocument(userID, documentStorageID);\n            this.setState({\n              showDocs: true,\n              selected: _objectSpread({\n                carName: carName\n              }, this.state.result[keys[k]])\n            });\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            style: {\n              fontSize: '95%'\n            },\n            children: carName\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: styles.previousMessageDate,\n            children: /*#__PURE__*/_jsx(\"p\", {\n              style: {\n                fontFamily: 'Gilroy-Semibold',\n                fontSize: '75%',\n                marginRight: '-10px',\n                paddingLeft: '10px'\n              },\n              children: dateOfQuery(timestamp)\n            })\n          })]\n        }), k == keys.length - 1 ? /*#__PURE__*/_jsx(_Fragment, {}) : /*#__PURE__*/_jsx(\"div\", {\n          className: styles.sharedLine,\n          style: {\n            marginTop: '5px'\n          }\n        })]\n      }));\n    }\n\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.cont,\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: styles.container,\n        style: {\n          backgroundColor: colors.WHITE,\n          marginTop: '20px'\n        },\n        children: [/*#__PURE__*/_jsx(\"p\", {\n          className: styles.title,\n          style: {\n            color: colors.BLACK,\n            marginBottom: '20px'\n          },\n          children: this.state.showDocs ? /*#__PURE__*/_jsxs(_Fragment, {\n            children: [this.state.selected.carName, \" - \", /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                color: colors.GREEN\n              },\n              children: this.state.selected.plateNumber\n            })]\n          }) : 'Vehicle Applications'\n        }), this.state.showDocs ? /*#__PURE__*/_jsxs(_Fragment, {\n          children: [requirements, /*#__PURE__*/_jsx(\"img\", {\n            src: this.state.docVehicleImage,\n            className: styles.driverVehicleIMAGE\n          })]\n        }) : results]\n      }), this.state.showDocs ? /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.enterKilometerDiv,\n        style: {\n          marginTop: '20px',\n          marginBottom: '150px',\n          marginLeft: '2.5%',\n          width: '95%'\n        },\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: styles.button2,\n          style: {\n            backgroundColor: colors.RED\n          },\n          id: styles.buttonBottom,\n          onClick: () => {\n            this.setState({\n              showDocs: false\n            });\n          },\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: styles.buttonText1,\n            children: \"Cancel\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: styles.button2,\n          style: {\n            backgroundColor: colors.GREEN\n          },\n          id: styles.buttonBottom,\n          onClick: () => {\n            if (this.state.inspectionVerified && this.state.insuranceVerified && this.state.registrationVerified) {\n              const {\n                userID,\n                timestamp,\n                dateFormat\n              } = this.state.selected;\n              validateVehicle.call(this, userID, timestamp, dateFormat);\n              this.setState({\n                showDocs: false\n              });\n            } else alert('Please verify all the documents by ticking the green button next to it');\n          },\n          children: /*#__PURE__*/_jsx(\"p\", {\n            className: styles.buttonText1,\n            children: \"Approve Vehicle\"\n          })\n        })]\n      }) : /*#__PURE__*/_jsx(_Fragment, {})]\n    });\n  }\n\n}\n;","map":null,"metadata":{},"sourceType":"module"}