{"ast":null,"code":"function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport axios from 'axios';\nimport firebase from 'firebase';\nimport React from 'react';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { AiOutlineCamera, AiOutlineCheck } from 'react-icons/ai';\nimport { BsClockHistory, BsCloudUpload } from 'react-icons/bs';\nimport { CgAdd } from 'react-icons/cg';\nimport { RiShieldCheckFill } from 'react-icons/ri';\nimport Loader from 'react-loader-spinner';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport { makeid, colors } from '../../functions';\nimport styles from '../panel_layout.module.css';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default class DriverVehicles extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"loadResult\", () => {\n      if (this.state.userDetails) firebase.database().ref(`vehicles/${this.state.userDetails.userID}`).once('value', snapshot => {\n        this.setState({\n          result: snapshot.val()\n        });\n      }).catch(error => {\n        console.log(error.message);\n      });\n    });\n\n    this.state = {\n      result: null,\n      addVehicle: false,\n      userDetails: this.props.userDetails,\n      make: '',\n      model: '',\n      year: '',\n      color: '',\n      plateNumber: '',\n      vehicleImage: '',\n      vehicleImagePreview: '',\n      registration: '',\n      insurance: '',\n      inspection: '',\n      loading: false,\n      errorMessage: ''\n    };\n  }\n\n  componentDidMount() {\n    this.loadResult();\n  }\n\n  handleFileUpload() {\n    this.setState({\n      loading: true,\n      errorMessage: ''\n    }, () => {\n      const randomID = makeid(6);\n      firebase.storage().ref(`driverVehicleDocs/${this.state.userDetails.userID}/${randomID}/vehicleRegistration`).put(this.state.registration).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`driverVehicleDocs/${this.state.userDetails.userID}/${randomID}/vehicleInsurance`).put(this.state.insurance).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`driverVehicleDocs/${this.state.userDetails.userID}/${randomID}/vehicleInspection`).put(this.state.inspection).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`driverVehicleDocs/${this.state.userDetails.userID}/${randomID}/vehicleImage`).put(this.state.vehicleImage).catch(error => {\n        console.log(error.message);\n      });\n      firebase.storage().ref(`vehicles/${this.state.userDetails.userID}/${randomID}`).put(this.state.vehicleImage).catch(error => {\n        console.log(error.message);\n      });\n      axios.post('https://us-central1-perch-01.cloudfunctions.net/addVehicle', {\n        userID: this.state.userDetails.userID,\n        vehicle: {\n          make: this.state.make,\n          model: this.state.model,\n          color: this.state.color,\n          year: this.state.year,\n          plateNumber: this.state.plateNumber.toUpperCase(),\n          maxSeatNumber: 3,\n          displayImage: `driverVehicleDocs/${this.state.userDetails.userID}/${randomID}/vehicleImage.jpeg`,\n          documentStorageID: randomID\n        }\n      }).then(() => {\n        this.setState({\n          errorMessage: '',\n          loading: false,\n          make: '',\n          model: '',\n          year: '',\n          color: '',\n          plateNumber: '',\n          addVehicle: false\n        }, () => {\n          this.loadResult();\n        });\n      }).catch(error => {\n        this.setState({\n          errorMessage: error.message,\n          loading: false\n        });\n      });\n    });\n  }\n\n  render() {\n    if (!this.state.userDetails && this.props.userDetails) this.setState({\n      userDetails: this.props.userDetails\n    }, () => {\n      this.loadResult();\n    });\n    let vehicle = [];\n\n    if (this.state.result) {\n      const keys = Object.keys(this.state.result);\n\n      for (let k = 0; k < keys.length; k++) if (keys[k] != 'selected') vehicle.push( /*#__PURE__*/_jsx(Vehicle, {\n        data: this.state.result[keys[k]],\n        lastItem: k == keys.length - 1\n      }));\n    }\n\n    return /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: styles.cont,\n        style: {\n          height: '100%',\n          paddingTop: '10px',\n          position: 'relative'\n        },\n        children: this.state.addVehicle ? /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: styles.container,\n            style: {\n              backgroundColor: colors.WHITE,\n              marginTop: '20px'\n            },\n            children: [/*#__PURE__*/_jsx(\"p\", {\n              className: styles.title,\n              style: {\n                color: colors.BLACK\n              },\n              children: \"Add a vehicle\"\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.enterKilometerDiv,\n              style: {\n                marginTop: '15px'\n              },\n              children: [/*#__PURE__*/_jsx(\"input\", {\n                type: \"text\",\n                placeholder: \"Vehicle Make\",\n                className: styles.inputPaymentPanel,\n                style: {\n                  width: '49%',\n                  margin: '0px'\n                },\n                id: styles.inputPaymentPanel_ADD,\n                value: this.state.make,\n                onChange: event => {\n                  this.setState({\n                    make: event.target.value\n                  });\n                }\n              }), /*#__PURE__*/_jsx(\"input\", {\n                type: \"text\",\n                placeholder: \"Vehicle Model\",\n                className: styles.inputPaymentPanel,\n                style: {\n                  width: '49%',\n                  margin: '0px'\n                },\n                id: styles.inputPaymentPanel_ADD,\n                value: this.state.model,\n                onChange: event => {\n                  this.setState({\n                    model: event.target.value\n                  });\n                }\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.enterKilometerDiv,\n              style: {\n                marginTop: '10px'\n              },\n              children: [/*#__PURE__*/_jsx(\"input\", {\n                type: \"text\",\n                placeholder: \"Vehicle Year\",\n                className: styles.inputPaymentPanel,\n                style: {\n                  width: '49%',\n                  margin: '0px'\n                },\n                id: styles.inputPaymentPanel_ADD,\n                value: this.state.year,\n                onChange: event => {\n                  this.setState({\n                    year: event.target.value\n                  });\n                }\n              }), /*#__PURE__*/_jsx(\"input\", {\n                type: \"text\",\n                placeholder: \"Vehicle Color\",\n                className: styles.inputPaymentPanel,\n                style: {\n                  width: '49%',\n                  margin: '0px'\n                },\n                id: styles.inputPaymentPanel_ADD,\n                value: this.state.color,\n                onChange: event => {\n                  this.setState({\n                    color: event.target.value\n                  });\n                }\n              })]\n            }), /*#__PURE__*/_jsx(\"input\", {\n              type: \"text\",\n              placeholder: \"Plate Number\",\n              className: styles.inputPaymentPanel,\n              id: styles.inputPaymentPanel_ADD,\n              style: {\n                marginTop: '10px'\n              },\n              value: this.state.plateNumber,\n              onChange: event => {\n                this.setState({\n                  plateNumber: event.target.value\n                });\n              }\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.driver_ADD_VEHICLE_LOWER,\n              children: [this.state.vehicleImagePreview == '' ? /*#__PURE__*/_jsxs(\"div\", {\n                className: styles.driver_ADD_VEHICLE_IMGUPLOAD,\n                onClick: () => {\n                  this.vehicleImage.click();\n                },\n                children: [/*#__PURE__*/_jsx(AiOutlineCamera, {\n                  className: styles.driverVehicle_CAMERA\n                }), /*#__PURE__*/_jsx(\"p\", {\n                  className: styles.driverVehicle_CAMERATEXT,\n                  children: \"UPLOAD A PICTURE OF YOUR VEHICLE\"\n                })]\n              }) : /*#__PURE__*/_jsx(\"img\", {\n                className: styles.driver_ADD_VEHICLE_IMGUPLOAD,\n                src: this.state.vehicleImagePreview,\n                onClick: () => {\n                  this.vehicleImage.click();\n                }\n              }), /*#__PURE__*/_jsxs(\"a\", {\n                className: styles.driver_ADD_VEHICLE_IMG_GL,\n                href: \"/s/articles/procedures_for_taking_a_picture\",\n                children: [/*#__PURE__*/_jsx(\"img\", {\n                  src: \"/cameraGuidelinesForPictures.svg\",\n                  className: styles.driverVehicle_GUIDELINES_CAM\n                }), /*#__PURE__*/_jsx(\"p\", {\n                  className: styles.driverVehicle_GUIDELINES_CAM_TEXT,\n                  children: \"Guidelines for taking a picture of your vehicle\"\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: styles.driver_ADD_VEHICLE_DOCSUPLOAD,\n                children: [/*#__PURE__*/_jsx(\"input\", {\n                  type: \"file\",\n                  ref: ref => this.vehicleRegistrationRef = ref,\n                  className: styles.driverVehicle_INPUT,\n                  onChange: event => {\n                    if (event.target.files.length != 0) {\n                      if (event.target.files[0].size / 1024 / 1024 > 10) this.setState({\n                        errorMessage: 'File size is too large. A maximum of 10 megabytes is permitted for uploads'\n                      });else this.setState({\n                        registration: event.target.files[0]\n                      });\n                    }\n                  }\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"file\",\n                  ref: ref => this.vehicleInsuranceRef = ref,\n                  className: styles.driverVehicle_INPUT,\n                  onChange: event => {\n                    if (event.target.files.length != 0) {\n                      if (event.target.files[0].size / 1024 / 1024 > 10) this.setState({\n                        errorMessage: 'File size is too large. A maximum of 10 megabytes is permitted for uploads'\n                      });else this.setState({\n                        insurance: event.target.files[0]\n                      });\n                    }\n                  }\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"file\",\n                  ref: ref => this.vehicleInspectionRef = ref,\n                  className: styles.driverVehicle_INPUT,\n                  onChange: event => {\n                    if (event.target.files.length != 0) {\n                      if (event.target.files[0].size / 1024 / 1024 > 10) this.setState({\n                        errorMessage: 'File size is too large. A maximum of 10 megabytes is permitted for uploads'\n                      });else this.setState({\n                        inspection: event.target.files[0]\n                      });\n                    }\n                  }\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"file\",\n                  ref: ref => this.vehicleImage = ref,\n                  className: styles.driverVehicle_INPUT,\n                  onChange: event => {\n                    if (event.target.files.length != 0) {\n                      if (event.target.files[0].size / 1024 / 1024 > 10) this.setState({\n                        errorMessage: 'File size is too large. A maximum of 10 megabytes is permitted for uploads'\n                      });else this.setState({\n                        vehicleImage: event.target.files[0],\n                        vehicleImagePreview: URL.createObjectURL(event.target.files[0])\n                      });\n                    }\n                  }\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: styles.driverVehicle_UPLOADCONT,\n                  id: styles.driverVehicle_UPLOADCONT_,\n                  onClick: () => {\n                    this.vehicleRegistrationRef.click();\n                  },\n                  children: [/*#__PURE__*/_jsx(\"p\", {\n                    className: styles.driverVehicle_UPLOADTEXT,\n                    children: this.state.registration == '' ? 'Upload vehicle registration' : this.state.registration.name\n                  }), this.state.registration == '' ? /*#__PURE__*/_jsx(BsCloudUpload, {\n                    size: '20px',\n                    style: {\n                      marginLeft: '10px',\n                      minWidth: '20px'\n                    },\n                    color: colors.WHITE\n                  }) : /*#__PURE__*/_jsx(AiOutlineCheck, {\n                    size: '20px',\n                    style: {\n                      marginLeft: '10px',\n                      minWidth: '20px'\n                    },\n                    color: colors.WHITE\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: styles.driverVehicle_UPLOADCONT,\n                  onClick: () => {\n                    this.vehicleInsuranceRef.click();\n                  },\n                  children: [/*#__PURE__*/_jsx(\"p\", {\n                    className: styles.driverVehicle_UPLOADTEXT,\n                    children: this.state.insurance == '' ? 'Upload vehicle insurance' : this.state.insurance.name\n                  }), this.state.insurance == '' ? /*#__PURE__*/_jsx(BsCloudUpload, {\n                    size: '20px',\n                    style: {\n                      marginLeft: '10px',\n                      minWidth: '20px'\n                    },\n                    color: colors.WHITE\n                  }) : /*#__PURE__*/_jsx(AiOutlineCheck, {\n                    size: '20px',\n                    style: {\n                      marginLeft: '10px',\n                      minWidth: '20px'\n                    },\n                    color: colors.WHITE\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: styles.driverVehicle_UPLOADCONT,\n                  onClick: () => {\n                    this.vehicleInspectionRef.click();\n                  },\n                  children: [/*#__PURE__*/_jsx(\"p\", {\n                    className: styles.driverVehicle_UPLOADTEXT,\n                    children: this.state.inspection == '' ? 'Upload vehicle inspection' : this.state.inspection.name\n                  }), this.state.inspection == '' ? /*#__PURE__*/_jsx(BsCloudUpload, {\n                    size: '20px',\n                    style: {\n                      marginLeft: '10px',\n                      minWidth: '20px'\n                    },\n                    color: colors.WHITE\n                  }) : /*#__PURE__*/_jsx(AiOutlineCheck, {\n                    size: '20px',\n                    style: {\n                      marginLeft: '10px',\n                      minWidth: '20px'\n                    },\n                    color: colors.WHITE\n                  })]\n                })]\n              })]\n            }), /*#__PURE__*/_jsx(\"p\", {\n              className: styles.em,\n              style: {\n                textAlign: 'initial'\n              },\n              children: this.state.errorMessage\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: styles.enterKilometerDiv,\n            style: {\n              marginTop: '20px',\n              marginLeft: '2.5%',\n              width: '95%'\n            },\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: styles.button2,\n              style: {\n                backgroundColor: colors.RED\n              },\n              id: styles.buttonBottom,\n              onClick: () => {\n                if (!this.state.loading) this.setState({\n                  addVehicle: false,\n                  errorMessage: ''\n                });\n              },\n              children: /*#__PURE__*/_jsx(\"p\", {\n                className: styles.buttonText1,\n                children: \"Cancel\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: styles.button2,\n              style: {\n                backgroundColor: colors.BLUE\n              },\n              id: styles.buttonBottom,\n              onClick: () => {\n                if (!this.state.loading) {\n                  if (this.state.color == '' || this.state.model == '' || this.state.make == '' || this.state.year == '' || this.state.plateNumber == '') this.setState({\n                    errorMessage: 'Please fill all fields'\n                  });else if (this.state.inspection == '' || this.state.registration == '' || this.state.insurance == '') this.setState({\n                    errorMessage: 'Please upload all documents needed'\n                  });else if (this.state.vehicleImage == '') this.setState({\n                    errorMessage: 'Please upload an image of your vehicle. It does not have to fit perfectly in frame.'\n                  });else this.handleFileUpload();\n                }\n              },\n              children: this.state.loading ? /*#__PURE__*/_jsx(Loader, {\n                type: \"TailSpin\",\n                color: colors.WHITE,\n                height: '20px',\n                width: '20px'\n              }) : /*#__PURE__*/_jsx(\"p\", {\n                className: styles.buttonText1,\n                children: \"Add vehicle\"\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            style: {\n              height: '150px',\n              width: '10px'\n            }\n          })]\n        }) : /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: styles.tripPanelDesc,\n            id: styles.tripPanelCalenderCont_AV,\n            onClick: () => {\n              this.setState({\n                addVehicle: true\n              });\n            },\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.tripPanelCalenderCont,\n              style: {\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsx(CgAdd, {\n                color: colors.WHITE,\n                style: {\n                  margin: '0px',\n                  minWidth: '20px',\n                  marginRight: '10px',\n                  height: '20px'\n                }\n              }), /*#__PURE__*/_jsx(\"p\", {\n                className: styles.driverVehicle_ADDAVEHICLE,\n                style: {\n                  margin: '0px',\n                  marginTop: '3px'\n                },\n                children: \"ADD A VEHICLE\"\n              })]\n            })\n          }), this.state.result ? this.state.result == 'NORESULTS' ? /*#__PURE__*/_jsxs(\"div\", {\n            className: styles.tripPanelLoading,\n            id: styles.tripPanelLoading_,\n            children: [/*#__PURE__*/_jsx(\"img\", {\n              src: \"/noResultsWoman.svg\",\n              className: styles.noResultsWoman,\n              alt: \"No Results\"\n            }), /*#__PURE__*/_jsx(\"p\", {\n              className: styles.contactUsLasttext,\n              style: {\n                width: 'initial',\n                fontSize: '90%',\n                margin: '0px'\n              },\n              id: styles.tripPanelLoadingText,\n              children: \"We can't find any vehicles in your name at the moment\"\n            })]\n          }) : vehicle : /*#__PURE__*/_jsx(\"div\", {\n            className: styles.tripPanelLoading,\n            children: /*#__PURE__*/_jsx(Loader, {\n              type: \"TailSpin\",\n              color: colors.BLUE,\n              height: '100px',\n              width: '100px'\n            })\n          })]\n        })\n      })\n    });\n  }\n\n}\n;\n\nclass Vehicle extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"setImage\", photoRef => {\n      firebase.storage().ref(`${photoRef}`).getDownloadURL().then(result => {\n        this.setState({\n          url: result\n        });\n      }).catch(error => {\n        console.log(error.message);\n      });\n    });\n\n    this.state = {\n      verified: this.props.data.verifyStatus == 'VERIFIED',\n      url: null\n    };\n  }\n\n  componentDidMount() {\n    this.setImage(this.props.data.displayImage);\n  }\n\n  render() {\n    const data = this.props.data;\n    return /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        id: styles.tripPanelCont_,\n        style: {\n          overflow: 'hidden',\n          flexDirection: 'row'\n        },\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: styles.driverVehicle_PIC_CONT,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: this.state.url,\n            className: styles.driverVehicle_PIC\n          })\n        }), /*#__PURE__*/_jsxs(\"p\", {\n          className: styles.driverVehicle_DESC,\n          children: [\"Color - \", data.color, /*#__PURE__*/_jsx(\"br\", {}), \"Year - \", data.year, /*#__PURE__*/_jsx(\"br\", {}), \"Make - \", data.make, /*#__PURE__*/_jsx(\"br\", {}), \"Model - \", data.model]\n        }), this.state.verified ? /*#__PURE__*/_jsxs(\"div\", {\n          id: styles.driverVehicle_VERIFYCONT,\n          style: {\n            backgroundColor: '#39A2E5'\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            id: styles.driverVehicle_VERIFYCONTTEXT,\n            children: \"Verified\"\n          }), /*#__PURE__*/_jsx(RiShieldCheckFill, {\n            className: styles.settingsVerifyOrNotIcon,\n            style: {\n              margin: '0px'\n            },\n            color: colors.WHITE\n          })]\n        }) : /*#__PURE__*/_jsxs(\"div\", {\n          id: styles.driverVehicle_VERIFYCONT,\n          style: {\n            backgroundColor: '#FF4040'\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            id: styles.driverVehicle_VERIFYCONTTEXT,\n            children: \"Verifying\"\n          }), /*#__PURE__*/_jsx(BsClockHistory, {\n            className: styles.settingsVerifyOrNotIcon,\n            style: {\n              margin: '0px'\n            },\n            color: colors.WHITE\n          })]\n        }), /*#__PURE__*/_jsx(\"p\", {\n          id: styles.driverVehiclePLATENUMBER,\n          children: data.plateNumber\n        })]\n      }), this.props.lastItem ?\n      /*#__PURE__*/\n      //just for padding at the bottom\n      _jsx(\"div\", {\n        style: {\n          height: '150px',\n          width: '100%',\n          backgroundColor: 'transparent'\n        }\n      }) : /*#__PURE__*/_jsx(_Fragment, {})]\n    });\n  }\n\n}\n\n;","map":null,"metadata":{},"sourceType":"module"}