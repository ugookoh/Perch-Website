{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport firebase from 'firebase';\nimport Router from 'next/router';\nimport axios from 'axios';\nexport function signIn(email, password, type) {\n  var _this = this;\n\n  this.setState({\n    error: false,\n    errorMessage: '',\n    loading: true\n  }, function () {\n    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function () {\n      firebase.auth().signInWithEmailAndPassword(email, password).then(function () {\n        if (type == 'user') {\n          var userID = firebase.auth().currentUser.uid;\n          firebase.database().ref(\"users/\".concat(userID, \"/summarizedHistory\")).once('value', function (snapshot) {\n            if (snapshot.val().phoneVerified == true) Router.push('/s/db/udash').then(function () {\n              return window.scrollTo(0, 0);\n            });else _this.setState({\n              displayVerification: true,\n              loading: false\n            });\n          })[\"catch\"](function (error) {\n            console.log(error.message);\n          });\n        } else if (type == 'driver') {\n          var _userID = firebase.auth().currentUser.uid;\n          firebase.database().ref(\"users/\".concat(_userID, \"/summarizedHistory\")).once('value', function (snapshot) {\n            if (snapshot.val().phoneVerified == true && snapshot.val().emailVerified == true) firebase.database().ref(\"users/\".concat(_userID, \"/driverVerified\")).once('value', function (snap) {\n              if (snap.val() == 'VERIFIED') Router.push('/s/db/ddash').then(function () {\n                return window.scrollTo(0, 0);\n              });else Router.push('/s/db/d_app_dash').then(function () {\n                return window.scrollTo(0, 0);\n              });\n            })[\"catch\"](function (error) {\n              console.log(error.message);\n            });else _this.setState({\n              displayVerification: true,\n              loading: false\n            });\n          })[\"catch\"](function (error) {\n            console.log(error.message);\n          });\n        }\n      })[\"catch\"](function (error) {\n        _this.setState({\n          error: true,\n          errorMessage: error.message,\n          loading: false\n        });\n      });\n    })[\"catch\"](function (error) {\n      _this.setState({\n        error: true,\n        errorMessage: error.message,\n        loading: false\n      });\n    });\n  });\n}\n;\nexport function adminSignIn(email, password) {\n  var _this2 = this;\n\n  this.setState({\n    error: false,\n    errorMessage: '',\n    loading: true\n  }, function () {\n    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.SESSION).then(function () {\n      firebase.auth().signInWithEmailAndPassword(email, password).then(function () {\n        var userID = firebase.auth().currentUser.uid;\n        firebase.database().ref(\"adminAuthorized/\".concat(userID)).once('value', function (snapshot) {\n          if (snapshot.val()) Router.push('/admin/dash').then(function () {\n            return window.scrollTo(0, 0);\n          });else _this2.setState({\n            error: true,\n            errorMessage: 'You do not have access to this portion of the site. Please contact us for help.',\n            loading: false\n          }, function () {\n            firebase.auth().signOut()[\"catch\"](function (error) {\n              console.log(error.message);\n            });\n          });\n        })[\"catch\"](function (error) {\n          console.log(error.message);\n        });\n      })[\"catch\"](function (error) {\n        _this2.setState({\n          error: true,\n          errorMessage: error.message,\n          loading: false\n        });\n      });\n    })[\"catch\"](function (error) {\n      _this2.setState({\n        error: true,\n        errorMessage: error.message,\n        loading: false\n      });\n    });\n  });\n}\nexport function signUp(firstName, lastName, email, countryCode, phoneNumber, password) {\n  var _this3 = this;\n\n  this.setState({\n    error: false,\n    errorMessage: '',\n    loading: true\n  }, function () {\n    firebase.auth().createUserWithEmailAndPassword(email, password).then(function () {\n      var userID = firebase.auth().currentUser.uid;\n      axios.post('https://us-central1-perch-01.cloudfunctions.net/createUserDetails', {\n        firstName: firstName,\n        lastName: lastName,\n        email: email,\n        phoneNumber: \"+\".concat(countryCode).concat(phoneNumber),\n        userID: userID\n      }).then(function (result) {\n        if (result.data == 'COMPLETE') _this3.setState({\n          displayVerification: true,\n          loading: false\n        });\n      })[\"catch\"](function (error) {\n        _this3.setState({\n          errorMessage: error.message,\n          loading: false\n        });\n      });\n    })[\"catch\"](function (error) {\n      _this3.setState({\n        error: true,\n        errorMessage: error.message,\n        loading: false\n      });\n    });\n  });\n}\n;\nexport function signOut(doNotReroute) {\n  firebase.auth().signOut().then(function () {\n    if (!doNotReroute) Router.push('/');\n  })[\"catch\"](function (error) {\n    console.log(error.message);\n  });\n}\nexport function sendFeedback() {\n  var _this4 = this;\n\n  if (this.state.topic == 'unselected') this.setState({\n    errorMessage: 'A topic is needed. Please pick a topic to contact us about. If you do not have one, please pick \"Other\"'\n  });else if (this.state.message == '') this.setState({\n    errorMessage: 'Please enter a message'\n  });else {\n    this.setState({\n      loading: true\n    }, function () {\n      if (_this4.state.userDetails) {\n        var ref = _this4.state.userDetails.driverID ? \"driverFeedback/\".concat(_this4.state.userDetails.driverID) : \"userFeedback/\".concat(_this4.state.userDetails.userID);\n        firebase.database().ref(ref).update(_defineProperty({}, new Date().getTime(), {\n          body: _this4.state.message,\n          subject: _this4.state.topic,\n          status: 'UNPROCESSED',\n          date: getDate()\n        })).then(function () {\n          _this4.setState({\n            topic: 'unselected',\n            message: '',\n            loading: false\n          }, function () {\n            _this4.loadResult();\n          });\n        })[\"catch\"](function (error) {\n          console.log(error.message);\n        });\n      } else firebase.database().ref(\"userFeedbackEmail\").update(_defineProperty({}, makeid(5), {\n        body: _this4.state.message,\n        subject: _this4.state.topic,\n        status: 'UNPROCESSED',\n        date: getDate(),\n        email: _this4.state.userEmail\n      })).then(function () {\n        _this4.setState({\n          topic: 'unselected',\n          message: '',\n          loading: false\n        });\n      })[\"catch\"](function (error) {\n        console.log(error.message);\n      });\n    });\n  }\n}\n;\nexport function changePassword(email_, oldPassword, newPassword) {\n  var _this5 = this;\n\n  this.setState({\n    loading: true\n  }, function () {\n    var email = email_;\n    var password = oldPassword;\n    firebase.auth().signInWithEmailAndPassword(email, password).then(function () {\n      firebase.auth().currentUser.updatePassword(newPassword).then(function () {\n        _this5.setState({\n          loading: false,\n          toShow: 'default',\n          currentPassword: '',\n          newPassword: '',\n          confirmNewPassword: ''\n        });\n      })[\"catch\"](function (error) {\n        return _this5.setState({\n          errorMessage: error.message,\n          loading: false,\n          newPassword: '',\n          confirmNewPassword: ''\n        });\n      });\n    })[\"catch\"](function (error) {\n      return _this5.setState({\n        errorMessage: error.message,\n        loading: false,\n        newPassword: '',\n        confirmNewPassword: ''\n      });\n    });\n  });\n}\n;\nexport function deleteAccount(email, password) {\n  var _this6 = this;\n\n  this.setState({\n    loading: true\n  }, function () {\n    firebase.auth().signInWithEmailAndPassword(email, password).then(function () {\n      var user = firebase.auth().currentUser;\n      var userID = user.uid;\n      user[\"delete\"]().then(function () {\n        firebase.database().ref(\"users/\".concat(userID)).remove()[\"catch\"](function (error) {\n          console.log(error.message);\n        });\n        firebase.database().ref(\"deletedAccountReasons\").update(_defineProperty({}, userID, {\n          reason: _this6.state.deleteAccountReason,\n          reviewed: false,\n          userDetails: _this6.state.userDetails\n        }))[\"catch\"](function (error) {\n          console.log(error.message);\n        });\n      })[\"catch\"](function (error) {\n        return _this6.setState({\n          errorMessage: error.message,\n          loading: false,\n          password1: ''\n        });\n      });\n    })[\"catch\"](function (error) {\n      return _this6.setState({\n        errorMessage: error.message,\n        loading: false,\n        password1: ''\n      });\n    });\n  });\n}\n;\nexport function sendPasswordResetLink(email) {\n  var _this7 = this;\n\n  firebase.auth().sendPasswordResetEmail(email).then(function () {\n    _this7.setState({\n      error: false,\n      errorMessage: '',\n      forgotPassword: false\n    });\n  })[\"catch\"](function (error) {\n    _this7.setState({\n      error: true,\n      errorMessage: error.message\n    });\n  });\n}\nexport function sendEmail(name, email, type, subject) {\n  axios.post(\"https://us-central1-perch-01.cloudfunctions.net/sendVerificationEmail\", {\n    name: name,\n    email: email,\n    type: type,\n    subject: subject\n  })[\"catch\"](function (error) {\n    console.log(error.meesage);\n  });\n}\nexport function resetPassword(code, newPassword, email) {\n  var _this8 = this;\n\n  this.setState({\n    errorMessage: '',\n    loading: true\n  }, function () {\n    firebase.auth().confirmPasswordReset(code, newPassword).then(function () {\n      firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function () {\n        firebase.auth().signInWithEmailAndPassword(email, newPassword).then(function () {\n          var userID = firebase.auth().currentUser.uid;\n          firebase.database().ref(\"users/\".concat(userID, \"/firstName\")).once('value', function (snap) {\n            sendEmail(snap.val(), email, 'passwordHasBeenReset', 'Password has been reset');\n          })[\"catch\"](function (error) {\n            console.log(error.message);\n          });\n        })[\"catch\"](function (error) {\n          console.log(error.message);\n        });\n      })[\"catch\"](function (error) {\n        console.log(error.message);\n      });\n      Router.push('/'); //send an email that password has been set \n    })[\"catch\"](function () {\n      _this8.setState({\n        errorMessage: 'The link is no longer valid, please go to the login page and request a new password reset link',\n        loading: false\n      });\n    });\n  });\n}\n; //MAKE A RANDOMID\n\nexport function makeid(length) {\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n\n  return \"\".concat(new Date().getTime()).concat(result);\n}\n;\nexport function getDate() {\n  var DAY = new Date().getDate();\n  var MONTH = new Date().getMonth();\n  var YEAR = new Date().getFullYear();\n  var HOUR = new Date().getHours();\n  var MIN = new Date().getMinutes();\n  var SECOND = new Date().getSeconds();\n  return \"\".concat(YEAR, \"-\").concat(MONTH, \"-\").concat(DAY, \"-\").concat(HOUR, \"-\").concat(MIN, \"-\").concat(SECOND);\n}\n;\nexport function dateformat(time) {\n  var slash1 = 0,\n      slash2 = 0,\n      slash3 = 0;\n\n  for (var k = 0; k < time.length; k++) {\n    if (time.charAt(k) == '-') slash1 == 0 ? slash1 = k : slash2 == 0 ? slash2 = k : slash3 = k;\n    if (slash3 != 0) break;\n  }\n\n  ;\n  var y = time.substring(0, slash1);\n  var m = time.substring(slash1 + 1, slash2);\n  var d = time.substring(slash2 + 1, slash3);\n  return \"\".concat(d, \"/\").concat(Number(m) + 1, \"/\").concat(y);\n}\n;\nexport function polylineLenght(data) {\n  var distance = 0;\n\n  for (var k = 0; k < data.length - 1; k++) {\n    distance += distanceCalculator(data[k][0], data[k][1], data[k + 1][0], data[k + 1][1]);\n  }\n\n  return distance;\n}\n;\nexport function distanceCalculator(lat1, lon1, lat2, lon2) {\n  var R = 6371 * 1000; // Radius of the earth in m\n\n  var dLat = deg2rad(lat2 - lat1); // deg2rad below\n\n  var dLon = deg2rad(lon2 - lon1);\n  var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  var d = R * c; // Distance in m\n\n  return d;\n}\n;\nexport function emailFormat(email, type) {\n  //@ is stored as -(hyphen)\n  //. is stored as _(underscore)\n  switch (type) {\n    case 'emailToString':\n      {\n        return email.replace('@', '-').replace('.', '_');\n      }\n      break;\n\n    case 'stringToEmail':\n      {\n        return email.replace('-', '@').replace('_', '.');\n      }\n      break;\n  }\n}\n;\n\nfunction deg2rad(deg) {\n  return deg * (Math.PI / 180);\n}\n\n;","map":{"version":3,"sources":["/Users/edokoh9/Documents/PerchWebsite/perch/functions/functions.js"],"names":["firebase","Router","axios","signIn","email","password","type","setState","error","errorMessage","loading","auth","setPersistence","Auth","Persistence","LOCAL","then","signInWithEmailAndPassword","userID","currentUser","uid","database","ref","once","snapshot","val","phoneVerified","push","window","scrollTo","displayVerification","console","log","message","emailVerified","snap","adminSignIn","SESSION","signOut","signUp","firstName","lastName","countryCode","phoneNumber","createUserWithEmailAndPassword","post","result","data","doNotReroute","sendFeedback","state","topic","userDetails","driverID","update","Date","getTime","body","subject","status","date","getDate","loadResult","makeid","userEmail","changePassword","email_","oldPassword","newPassword","updatePassword","toShow","currentPassword","confirmNewPassword","deleteAccount","user","remove","reason","deleteAccountReason","reviewed","password1","sendPasswordResetLink","sendPasswordResetEmail","forgotPassword","sendEmail","name","meesage","resetPassword","code","confirmPasswordReset","length","characters","charactersLength","i","charAt","Math","floor","random","DAY","MONTH","getMonth","YEAR","getFullYear","HOUR","getHours","MIN","getMinutes","SECOND","getSeconds","dateformat","time","slash1","slash2","slash3","k","y","substring","m","d","Number","polylineLenght","distance","distanceCalculator","lat1","lon1","lat2","lon2","R","dLat","deg2rad","dLon","a","sin","cos","c","atan2","sqrt","emailFormat","replace","deg","PI"],"mappings":"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","sourcesContent":["import firebase from 'firebase';\nimport Router from 'next/router';\nimport axios from 'axios';\n\n\nexport function signIn(email, password, type) {\n    this.setState({ error: false, errorMessage: '', loading: true }, () => {\n        firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(() => {\n            firebase.auth().signInWithEmailAndPassword(email, password)\n                .then(() => {\n                    if (type == 'user') {\n                        const userID = firebase.auth().currentUser.uid;\n                        firebase.database().ref(`users/${userID}/summarizedHistory`).once('value', snapshot => {\n                            if (snapshot.val().phoneVerified == true)\n                                Router.push('/s/db/udash').then(() => window.scrollTo(0, 0));\n                            else\n                                this.setState({ displayVerification: true, loading: false });\n                        }).catch(error => { console.log(error.message) });\n\n                    }\n                    else if (type == 'driver') {\n                        const userID = firebase.auth().currentUser.uid;\n                        firebase.database().ref(`users/${userID}/summarizedHistory`).once('value', snapshot => {\n                            if (snapshot.val().phoneVerified == true && snapshot.val().emailVerified == true)\n                                firebase.database().ref(`users/${userID}/driverVerified`).once('value', snap => {\n                                    if (snap.val() == 'VERIFIED')\n                                        Router.push('/s/db/ddash').then(() => window.scrollTo(0, 0));\n                                    else\n                                        Router.push('/s/db/d_app_dash').then(() => window.scrollTo(0, 0));\n                                }).catch(error => { console.log(error.message) })\n                            else\n                                this.setState({ displayVerification: true, loading: false });\n                        }).catch(error => { console.log(error.message) });\n                    }\n                })\n                .catch(error => { this.setState({ error: true, errorMessage: error.message, loading: false }) });\n        }).catch(error => { this.setState({ error: true, errorMessage: error.message, loading: false }) });\n    })\n};\n\nexport function adminSignIn(email, password) {\n    this.setState({ error: false, errorMessage: '', loading: true }, () => {\n        firebase.auth().setPersistence(firebase.auth.Auth.Persistence.SESSION).then(() => {\n            firebase.auth().signInWithEmailAndPassword(email, password)\n                .then(() => {\n                    const userID = firebase.auth().currentUser.uid;\n                    firebase.database().ref(`adminAuthorized/${userID}`)\n                        .once('value', snapshot => {\n                            if (snapshot.val())\n                                Router.push('/admin/dash').then(() => window.scrollTo(0, 0));\n                            else\n                                this.setState({ error: true, errorMessage: 'You do not have access to this portion of the site. Please contact us for help.', loading: false }, () => {\n                                    firebase.auth().signOut().catch(error => { console.log(error.message) });\n                                })\n                        })\n                        .catch(error => { console.log(error.message) })\n                })\n                .catch(error => { this.setState({ error: true, errorMessage: error.message, loading: false }) });\n        }).catch(error => { this.setState({ error: true, errorMessage: error.message, loading: false }) });\n    })\n}\n\nexport function signUp(firstName, lastName, email, countryCode, phoneNumber, password) {\n\n    this.setState({ error: false, errorMessage: '', loading: true }, () => {\n        firebase.auth().createUserWithEmailAndPassword(email, password)\n            .then(() => {\n                const userID = firebase.auth().currentUser.uid;\n                axios.post('https://us-central1-perch-01.cloudfunctions.net/createUserDetails', { firstName: firstName, lastName: lastName, email: email, phoneNumber: `+${countryCode}${phoneNumber}`, userID: userID })\n                    .then((result => {\n                        if (result.data == 'COMPLETE')\n                            this.setState({ displayVerification: true, loading: false });\n                    }))\n                    .catch(error => { this.setState({ errorMessage: error.message, loading: false }) });\n            }).catch(error => { this.setState({ error: true, errorMessage: error.message, loading: false }) });\n    })\n};\n\nexport function signOut(doNotReroute) {\n    firebase.auth().signOut()\n        .then(() => {\n            if (!doNotReroute)\n                Router.push('/');\n        })\n        .catch(error => { console.log(error.message) })\n}\n\nexport function sendFeedback() {\n    if (this.state.topic == 'unselected')\n        this.setState({ errorMessage: 'A topic is needed. Please pick a topic to contact us about. If you do not have one, please pick \"Other\"' })\n    else if (this.state.message == '')\n        this.setState({ errorMessage: 'Please enter a message' })\n    else {\n        this.setState({ loading: true }, () => {\n            if (this.state.userDetails) {\n                const ref = this.state.userDetails.driverID ? `driverFeedback/${this.state.userDetails.driverID}` : `userFeedback/${this.state.userDetails.userID}`;\n                firebase.database().ref(ref).update({\n                    [new Date().getTime()]: {\n                        body: this.state.message,\n                        subject: this.state.topic,\n                        status: 'UNPROCESSED',\n                        date: getDate(),\n                    }\n                }).then(() => {\n                    this.setState({ topic: 'unselected', message: '', loading: false }, () => { this.loadResult() })\n                }).catch(error => { console.log(error.message) });\n            }\n            else\n                firebase.database().ref(`userFeedbackEmail`).update({\n                    [makeid(5)]: {\n                        body: this.state.message,\n                        subject: this.state.topic,\n                        status: 'UNPROCESSED',\n                        date: getDate(),\n                        email: this.state.userEmail,\n                    }\n                }).then(() => {\n                    this.setState({ topic: 'unselected', message: '', loading: false })\n                }).catch(error => { console.log(error.message) });\n        })\n    }\n};\n\nexport function changePassword(email_, oldPassword, newPassword) {\n    this.setState({ loading: true }, () => {\n\n        const email = email_;\n        const password = oldPassword;\n\n        firebase.auth().signInWithEmailAndPassword(email, password)\n            .then(() => {\n                firebase.auth().currentUser.updatePassword(newPassword)\n                    .then(() => {\n                        this.setState({ loading: false, toShow: 'default', currentPassword: '', newPassword: '', confirmNewPassword: '' });\n                    })\n                    .catch(error => this.setState({ errorMessage: error.message, loading: false, newPassword: '', confirmNewPassword: '' }));\n            })\n            .catch(error => this.setState({ errorMessage: error.message, loading: false, newPassword: '', confirmNewPassword: '' }));\n    })\n};\n\nexport function deleteAccount(email, password) {\n    this.setState({ loading: true }, () => {\n        firebase.auth().signInWithEmailAndPassword(email, password)\n            .then(() => {\n                const user = firebase.auth().currentUser;\n                const userID = user.uid;\n                user.delete()\n                    .then(() => {\n                        firebase.database().ref(`users/${userID}`).remove().catch(error => { console.log(error.message) });\n                        firebase.database().ref(`deletedAccountReasons`).update({\n                            [userID]: {\n                                reason: this.state.deleteAccountReason,\n                                reviewed: false,\n                                userDetails: this.state.userDetails,\n                            },\n                        }).catch(error => { console.log(error.message) })\n                    })\n                    .catch(error => this.setState({ errorMessage: error.message, loading: false, password1: '' }));\n            })\n            .catch(error => this.setState({ errorMessage: error.message, loading: false, password1: '' }));\n    })\n};\nexport function sendPasswordResetLink(email) {\n    firebase.auth().sendPasswordResetEmail(email)\n        .then(() => {\n            this.setState({ error: false, errorMessage: '', forgotPassword: false })\n        }).catch(error => { this.setState({ error: true, errorMessage: error.message }) })\n}\nexport function sendEmail(name, email, type, subject) {\n    axios.post(`https://us-central1-perch-01.cloudfunctions.net/sendVerificationEmail`, { name: name, email: email, type: type, subject: subject })\n        .catch(error => { console.log(error.meesage) })\n}\n\nexport function resetPassword(code, newPassword, email) {\n    this.setState({ errorMessage: '', loading: true }, () => {\n        firebase.auth().confirmPasswordReset(code, newPassword)\n            .then(() => {\n                firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(() => {\n                    firebase.auth().signInWithEmailAndPassword(email, newPassword)\n                        .then(() => {\n                            const userID = firebase.auth().currentUser.uid;\n                            firebase.database().ref(`users/${userID}/firstName`)\n                                .once('value', snap => {\n                                    sendEmail(snap.val(), email, 'passwordHasBeenReset', 'Password has been reset');\n                                })\n                                .catch(error => { console.log(error.message) });\n                        })\n                        .catch(error => { console.log(error.message) });\n                }).catch(error => { console.log(error.message) });\n                Router.push('/');//send an email that password has been set \n            })\n            .catch(() => { this.setState({ errorMessage: 'The link is no longer valid, please go to the login page and request a new password reset link', loading: false }) })\n    })\n};\n//MAKE A RANDOMID\nexport function makeid(length) {\n    var result = '';\n    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var charactersLength = characters.length;\n    for (var i = 0; i < length; i++) {\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n    return `${new Date().getTime()}${result}`;\n};\n\nexport function getDate() {\n    const DAY = new Date().getDate();\n    const MONTH = new Date().getMonth();\n    const YEAR = new Date().getFullYear();\n    const HOUR = new Date().getHours();\n    const MIN = new Date().getMinutes();\n    const SECOND = new Date().getSeconds();\n\n    return (`${YEAR}-${MONTH}-${DAY}-${HOUR}-${MIN}-${SECOND}`);\n};\n\nexport function dateformat(time) {\n    let slash1 = 0, slash2 = 0, slash3 = 0;\n    for (let k = 0; k < time.length; k++) {\n        if (time.charAt(k) == '-')\n            slash1 == 0 ? slash1 = k : slash2 == 0 ? slash2 = k : slash3 = k;\n\n        if (slash3 != 0)\n            break;\n    };\n\n    const y = time.substring(0, slash1);\n    const m = time.substring(slash1 + 1, slash2);\n    const d = time.substring(slash2 + 1, slash3);\n\n    return `${d}/${Number(m) + 1}/${y}`;\n};\n\nexport function polylineLenght(data) {\n    let distance = 0;\n    for (let k = 0; k < data.length - 1; k++)\n        distance += distanceCalculator(data[k][0], data[k][1], data[k + 1][0], data[k + 1][1])\n\n    return (distance)\n};\n\nexport function distanceCalculator(lat1, lon1, lat2, lon2) {\n    let R = 6371 * 1000; // Radius of the earth in m\n    let dLat = deg2rad(lat2 - lat1);  // deg2rad below\n    let dLon = deg2rad(lon2 - lon1);\n    let a =\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n        Math.sin(dLon / 2) * Math.sin(dLon / 2)\n        ;\n    let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    let d = R * c; // Distance in m\n    return d;\n};\n\nexport function emailFormat(email, type) {\n    //@ is stored as -(hyphen)\n    //. is stored as _(underscore)\n    switch (type) {\n        case 'emailToString': {\n            return (email.replace('@', '-').replace('.', '_'));\n        } break;\n        case 'stringToEmail': {\n            return (email.replace('-', '@').replace('_', '.'));\n        } break;\n    }\n};\nfunction deg2rad(deg) {\n    return deg * (Math.PI / 180)\n};\n"]},"metadata":{},"sourceType":"module"}