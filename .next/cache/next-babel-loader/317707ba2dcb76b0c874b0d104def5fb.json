{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport Head from 'next/head';\nimport styles from './s/articles/layout.module.css';\nimport React from 'react';\nimport Header from './components/header/header';\nimport Footer from './components/footer/footer';\nimport Loader from 'react-loader-spinner';\nimport firebase from 'firebase';\nimport { resetPassword, emailFormat } from '../functions/functions';\nimport ShareIcons from '../functions/shareIcons';\nimport Router from 'next/router';\nimport axios from 'axios';\nexport default class index extends React.Component {\n  static async getInitialProps({\n    query\n  }) {\n    const {\n      mode,\n      oobCode,\n      email\n    } = query;\n    return {\n      mode: mode,\n      oobCode: oobCode,\n      email: email\n    };\n  }\n\n  constructor() {\n    super();\n    this.state = {\n      password: '',\n      confirmPassword: '',\n      loading: false,\n      errorMessage: '',\n      validationFailed: false,\n      validationCompleted: false\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.mode == 'verifyEmail' && this.props.email) {\n      const email = this.props.email;\n      axios.post(`https://us-central1-perch-01.cloudfunctions.net/findUidByEmail`, {\n        formattedEmail: emailFormat(email, 'emailToString')\n      }).then(r => {\n        if (r.data == 'DOESNOTEXIST') this.setState({\n          errorMessage: 'This user does not exist',\n          validationFailed: true\n        });else if (r.data) axios.post(`https://us-central1-perch-01.cloudfunctions.net/verifyEmailAndPhoneNumber`, {\n          type: 'email',\n          userID: r.data\n        }).then(() => {\n          this.setState({\n            validationCompleted: true\n          });\n        }).catch(error => {\n          this.setState({\n            errorMessage: error.message,\n            validationFailed: true\n          });\n        });else this.setState({\n          errorMessage: 'Network error, please try again',\n          validationFailed: true\n        });\n      }).catch(error => {\n        this.setState({\n          errorMessage: error.message,\n          validationFailed: true\n        });\n      });\n    }\n\n    ;\n  }\n\n  render() {\n    const {\n      mode,\n      oobCode,\n      email\n    } = this.props;\n\n    let title = '',\n        subtitle = '',\n        pageTitle = '',\n        content = /*#__PURE__*/_jsx(_Fragment, {});\n\n    switch (mode) {\n      case 'resetPassword':\n        {\n          pageTitle = 'Reset Password';\n          title = 'Reset your password form';\n          subtitle = 'Enter your new password and confirm it below.';\n          content = /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              type: \"password\",\n              placeholder: \"Enter new password\",\n              className: styles.contactUsEmail,\n              value: this.state.password,\n              onChange: event => {\n                this.setState({\n                  password: event.target.value\n                });\n              }\n            }), /*#__PURE__*/_jsx(\"input\", {\n              type: \"password\",\n              placeholder: \"Re-enter your new password\",\n              className: styles.contactUsEmail,\n              value: this.state.confirmPassword,\n              onChange: event => {\n                this.setState({\n                  confirmPassword: event.target.value\n                });\n              }\n            })]\n          });\n        }\n        break;\n\n      case 'recoverEmail':\n        {\n          pageTitle = 'Recover Email';\n        }\n        break;\n\n      case 'verifyEmail':\n        {\n          pageTitle = 'Verify Email';\n          title = 'Verify your email';\n          if (this.state.validationCompleted) subtitle = `Your email, ${email} has been verified`;else if (this.state.validationFailed) subtitle = 'Email verification failed. Please contact us for further assistance';else subtitle = 'Verifying...';\n        }\n        break;\n    }\n\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.container,\n      children: [/*#__PURE__*/_jsxs(Head, {\n        children: [/*#__PURE__*/_jsx(\"title\", {\n          children: `${pageTitle} | Perch`\n        }), /*#__PURE__*/_jsx(\"meta\", {\n          name: \"viewport\",\n          content: \"width=device-width, initial-scale=1\"\n        }), /*#__PURE__*/_jsx(\"link\", {\n          rel: \"icon\",\n          type: \"image/png\",\n          sizes: \"32x32\",\n          href: \"/favicon-32x32.png\"\n        }), /*#__PURE__*/_jsx(\"link\", {\n          rel: \"icon\",\n          type: \"image/png\",\n          sizes: \"16x16\",\n          href: \"/favicon-16x16.png\"\n        }), /*#__PURE__*/_jsx(\"link\", {\n          rel: \"apple-touch-icon\",\n          sizes: \"180x180\",\n          href: \"/apple-touch-icon.png\"\n        }), /*#__PURE__*/_jsx(\"link\", {\n          rel: \"manifest\",\n          href: \"/site.webmanifest\"\n        }), /*#__PURE__*/_jsx(\"link\", {\n          rel: \"mask-icon\",\n          href: \"/safari-pinned-tab.svg\",\n          color: \"#5bbad5\"\n        }), /*#__PURE__*/_jsx(\"meta\", {\n          name: \"theme-color\",\n          content: \"#ffffff\"\n        }), /*#__PURE__*/_jsx(\"html\", {\n          lang: \"en\"\n        })]\n      }), /*#__PURE__*/_jsx(Header, {}), /*#__PURE__*/_jsx(\"img\", {\n        src: \"/articlesPageBack1.svg\",\n        alt: \"Perch Carpool\",\n        className: styles.mainPageBack1\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.body,\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: styles.c_,\n          style: {\n            marginTop: '15px',\n            marginBottom: '20px',\n            justifyContent: 'space-between',\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: styles.t1,\n            style: {\n              margin: '0px'\n            },\n            children: title\n          }), /*#__PURE__*/_jsx(ShareIcons, {})]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.contactUsCont,\n          style: {\n            paddingBottom: '20px'\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            className: styles.contactUsTitle,\n            style: {\n              marginTop: '20px',\n              marginBottom: '0px'\n            },\n            children: subtitle\n          }), content, /*#__PURE__*/_jsx(\"p\", {\n            className: styles.em,\n            style: {\n              marginTop: '20px',\n              marginBottom: '0px'\n            },\n            children: this.state.errorMessage\n          })]\n        }), mode == 'resetPassword' ? /*#__PURE__*/_jsx(\"div\", {\n          className: styles.contactUsLC,\n          children: /*#__PURE__*/_jsx(\"a\", {\n            className: styles.button2,\n            onClick: () => {\n              switch (mode) {\n                case 'resetPassword':\n                  {\n                    if (this.state.password == '') this.setState({\n                      errorMessage: 'Please enter a new password'\n                    });else if (this.state.confirmPassword != this.state.password) this.setState({\n                      errorMessage: 'Passwords do not match'\n                    });else resetPassword.call(this, oobCode, this.state.password, email);\n                  }\n                  break;\n\n                case 'recoverEmail':\n                  {}\n                  break;\n\n                case 'verifyEmail':\n                  {}\n                  break;\n              }\n            },\n            children: this.state.loading ? /*#__PURE__*/_jsx(Loader, {\n              type: \"TailSpin\",\n              color: '#ffffff',\n              height: '20px',\n              width: '20px'\n            }) : /*#__PURE__*/_jsx(\"p\", {\n              className: styles.buttonText2,\n              children: \"Reset password\"\n            })\n          })\n        }) : /*#__PURE__*/_jsx(_Fragment, {})]\n      }), /*#__PURE__*/_jsx(Footer, {})]\n    });\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}