_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[51],{HkCf:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/s/db/d_app_dash",function(){return n("l2Oc")}])},l2Oc:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var a=n("1OyB"),c=n("vuIU"),s=n("JX7q"),i=n("Ji7U"),o=n("md7G"),r=n("foSv"),l=n("rePB"),d=n("nKUr"),h=n("q1tI"),j=n.n(h),u=n("mw2Z"),p=n.n(u),b=n("8Kt/"),O=n.n(b),f=n("+jxT"),m=n("Z6QF"),x=n("nOHt"),g=n.n(x),v=n("8rXc"),w=n("JZFu"),N=n("l099"),S=n("9uY5");function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(r.a)(e);if(t){var c=Object(r.a)(this).constructor;n=Reflect.construct(a,arguments,c)}else n=a.apply(this,arguments);return Object(o.a)(this,n)}}var _=function(e){Object(i.a)(n,e);var t=D(n);function n(){var e;return Object(a.a)(this,n),e=t.call(this),Object(l.a)(Object(s.a)(e),"setImage",(function(t){w.a.storage().ref("".concat(t)).getDownloadURL().then((function(t){e.setState({url:t})})).catch((function(e){console.log(e.message)}))})),Object(l.a)(Object(s.a)(e),"nextStage",(function(t){e.setState({currentState:{stage:t}})})),Object(l.a)(Object(s.a)(e),"updateWindowDimensions",(function(){e.setState({width:window.innerWidth,height:window.innerHeight})})),e.state={width:0,height:0,loggedIn:"NULL",currentState:{stage:"one"},userID:"",url:null,firstName:null},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),w.a.auth().onAuthStateChanged((function(t){t?e.setState({userID:t.uid},(function(){w.a.database().ref("users/".concat(t.uid,"/firstName")).once("value",(function(t){e.setState({firstName:t.val()})})).catch((function(e){console.log(e.message)})),w.a.database().ref("users/".concat(t.uid,"/photoRef")).once("value",(function(t){e.setImage(t.val())})).catch((function(e){console.log(e.message)})),w.a.database().ref("driverApplications/".concat(t.uid)).once("value",(function(n){n.val()?e.setState({currentState:n.val(),loggedIn:"TRUE"}):(w.a.database().ref("users/".concat(t.uid)).update({driverVerified:"UNVERIFIED"}).catch((function(e){console.log(e.message)})),w.a.database().ref("driverApplications/".concat(t.uid)).update({stage:"one"}).then((function(){e.setState({loggedIn:"TRUE"})})).catch((function(e){console.log(e.message)})))})).catch((function(e){console.log(e.message)}))})):e.setState({loggedIn:"FALSE"})}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){var e=this;if("FALSE"==this.state.loggedIn&&g.a.push("/s/auth/d_si_su").then((function(){return window.scrollTo(0,0)})),"TRUE"!=this.state.loggedIn)return Object(d.jsx)(N.default,{});var t=Object(d.jsx)(d.Fragment,{}),n="";switch(this.state.currentState.stage){case"one":n="Vehicle Confirmation",t=Object(d.jsx)(v.l,{userID:this.state.userID,nextStage:this.nextStage.bind(this)});break;case"two":n="Upload Documents",t=Object(d.jsx)(v.j,{userID:this.state.userID,nextStage:this.nextStage.bind(this)});break;case"three":n="Application Status",t=Object(d.jsx)(v.a,{userID:this.state.userID})}return Object(d.jsxs)("div",{className:p.a.container,style:{height:0!=this.state.height?this.state.height:"100vh"},children:[Object(d.jsxs)(O.a,{children:[Object(d.jsx)("title",{children:"Driver Application | Perch"}),Object(d.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),Object(d.jsx)("link",{rel:"icon",href:"/favicon.ico"}),Object(d.jsx)("html",{lang:"en"})]}),Object(d.jsxs)("div",{className:p.a.header,children:[Object(d.jsx)("div",{className:p.a.logoBox,children:Object(d.jsx)("a",{href:"/",children:Object(d.jsx)("div",{className:p.a.logo,children:Object(d.jsx)(m.c,{color:"#FFFFFF"})})})}),Object(d.jsxs)("div",{className:p.a.optionShadowBox,children:[Object(d.jsx)("p",{className:p.a.optionTitle,children:n}),Object(d.jsxs)("div",{className:p.a.textRow1,children:[this.state.firstName?Object(d.jsxs)(d.Fragment,{children:[this.state.url?Object(d.jsx)("img",{src:this.state.url,className:p.a.dp,style:{objectFit:"cover",borderWidth:"0px"}}):Object(d.jsx)("div",{className:p.a.dp}),Object(d.jsx)("p",{className:p.a.text_,children:"Hello, ".concat(this.state.firstName)})]}):Object(d.jsx)(d.Fragment,{}),Object(d.jsx)("a",{className:p.a.link_,href:"/s/articles/how_perch_works",children:Object(d.jsx)("p",{className:p.a.text,children:"How it works"})}),Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:p.a.circle,onClick:function(){S.h.call(e,!0)},children:Object(d.jsx)(f.a,{color:"#FFFFFF",className:p.a.logOut})})})]})]})]}),Object(d.jsxs)("div",{className:p.a.body,children:[Object(d.jsxs)("div",{className:p.a.couple,children:[Object(d.jsxs)("div",{className:p.a.column,children:[Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:"one"==this.state.currentState.stage?p.a.optionIcon_Selected:p.a.optionIcon,id:p.a.optionIcon_,children:Object(d.jsx)("div",{className:p.a.one,children:Object(d.jsx)(m.a,{icon:"one"})})})}),Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:"two"==this.state.currentState.stage?p.a.optionIcon_Selected:p.a.optionIcon,id:p.a.optionIcon_,children:Object(d.jsx)("div",{className:p.a.two,children:Object(d.jsx)(m.a,{icon:"two"})})})}),Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:"three"==this.state.currentState.stage?p.a.optionIcon_Selected:p.a.optionIcon,id:p.a.optionIcon_,children:Object(d.jsx)("div",{className:p.a.three,children:Object(d.jsx)(m.a,{icon:"three"})})})})]}),Object(d.jsxs)("div",{className:p.a.optionList,children:[Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:"one"==this.state.currentState.stage?p.a.optionDescriptionCont_Selected:p.a.optionDescriptionCont,id:p.a.optionDescriptionCont_,children:Object(d.jsx)("p",{className:p.a.optionDescription,children:"Vehicle Confirmation"})})}),Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:"two"==this.state.currentState.stage?p.a.optionDescriptionCont_Selected:p.a.optionDescriptionCont,id:p.a.optionDescriptionCont_,children:Object(d.jsx)("p",{className:p.a.optionDescription,children:"Upload Documents"})})}),Object(d.jsx)("a",{children:Object(d.jsx)("div",{className:"three"==this.state.currentState.stage?p.a.optionDescriptionCont_Selected:p.a.optionDescriptionCont,id:p.a.optionDescriptionCont_,children:Object(d.jsx)("p",{className:p.a.optionDescription,children:"Application Status"})})})]})]}),Object(d.jsx)("div",{className:p.a.content,children:t})]})]})}}]),n}(j.a.Component)}},[["HkCf",0,1,6,5,7,9,15,14,19,20,21,17,18,16,22,2,3,4,8,13,23,24]]]);