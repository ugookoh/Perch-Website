_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[58],{HkCf:function(t,e,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/s/db/d_app_dash",function(){return o("l2Oc")}])},l2Oc:function(t,e,o){"use strict";o.r(e),o.d(e,"default",(function(){return C}));var n=o("1OyB"),a=o("vuIU"),c=o("JX7q"),i=o("Ji7U"),s=o("md7G"),r=o("foSv"),l=o("rePB"),u=o("q1tI"),d=o.n(u),_=o("mw2Z"),p=o.n(_),h=o("8Kt/"),j=o.n(h),b=o("+jxT"),f=o("Z6QF"),g=o("nOHt"),O=o.n(g),m=o("8rXc"),x=o("JZFu"),v=o("l099"),y=o("9uY5"),w=o("vDqi"),D=o.n(w),S=o("nKUr");function N(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function I(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?N(Object(o),!0).forEach((function(e){Object(l.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):N(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function k(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=Object(r.a)(t);if(e){var a=Object(r.a)(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return Object(s.a)(this,o)}}var C=function(t){Object(i.a)(o,t);var e=k(o);function o(){var t;return Object(n.a)(this,o),t=e.call(this),Object(l.a)(Object(c.a)(t),"setImage",(function(e){x.a.storage().ref("".concat(e)).getDownloadURL().then((function(e){t.setState({url:e})})).catch((function(t){console.log(t.message)}))})),Object(l.a)(Object(c.a)(t),"nextStage",(function(e){t.setState({currentState:{stage:e}})})),Object(l.a)(Object(c.a)(t),"updateWindowDimensions",(function(){t.setState({width:window.innerWidth,height:window.innerHeight})})),t.state={width:0,height:0,loggedIn:"NULL",currentState:{stage:"one"},userID:"",url:null,firstName:null},t}return Object(a.a)(o,[{key:"componentDidMount",value:function(){var t=this;this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),x.a.auth().onAuthStateChanged((function(e){e?x.a.database().ref("users/".concat(e.uid,"/driverVerified")).once("value",(function(o){"VERIFIED"==o.val()?O.a.push("/s/db/ddash").then((function(){return window.scrollTo(0,0)})):t.setState({userID:e.uid},(function(){x.a.database().ref("users/".concat(e.uid,"/firstName")).once("value",(function(e){t.setState({firstName:e.val()})})).catch((function(t){console.log(t.message)})),x.a.database().ref("users/".concat(e.uid,"/photoRef")).once("value",(function(e){t.setImage(e.val())})).catch((function(t){console.log(t.message)})),x.a.database().ref("driverApplications/".concat(e.uid)).once("value",(function(o){o.val()?"four"==o.val().stage||"five"==o.val().stage?t.setState({currentState:I(I({},o.val()),{},{stage:"three"}),loggedIn:"TRUE"}):t.setState({currentState:o.val(),loggedIn:"TRUE"}):(D.a.post("https://us-central1-perch-01.cloudfunctions.net/updateUserDetails",{userID:e.uid,fieldsToUpdate:{driverVerified:"PENDING"}}).catch((function(t){alert(t.message)})),x.a.database().ref("users/".concat(e.uid)).once("value",(function(o){var n=o.val(),a=n.firstName,c=n.lastName,i="".concat(a," ").concat(c),s=(new Date).getTime(),r=new Date(s).getDate(),l=new Date(s).getMonth(),u=new Date(s).getFullYear(),d=new Date(s).getHours(),_=new Date(s).getMinutes(),p=new Date(s).getSeconds();x.a.database().ref("driverApplications/".concat(e.uid)).update({stage:"one",timestamp:s,name:i,vehicleRandomID:Object(y.q)(6),dateFormat:"".concat(u,"-").concat(l,"-").concat(r,"-").concat(d,"-").concat(_,"-").concat(p),verified:JSON.stringify([!1,!1,!1,!1,!1,!1]),offerLetterSigned:!1}).then((function(){t.setState({loggedIn:"TRUE"})})).catch((function(t){console.log(t.message)}))})).catch((function(t){console.log(t.message)})))})).catch((function(t){console.log(t.message)}))}))})):t.setState({loggedIn:"FALSE"})}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){var t=this;if("FALSE"==this.state.loggedIn&&O.a.push("/s/auth/d_si_su").then((function(){return window.scrollTo(0,0)})),"TRUE"!=this.state.loggedIn)return Object(S.jsx)(v.default,{});var e=Object(S.jsx)(S.Fragment,{}),o="";switch(this.state.currentState.stage){case"one":o="Vehicle Confirmation",e=Object(S.jsx)(m.v,{userID:this.state.userID,nextStage:this.nextStage.bind(this)});break;case"two":o="Upload Documents",e=Object(S.jsx)(m.s,{userID:this.state.userID,nextStage:this.nextStage.bind(this)});break;case"three":o="Application Status",e=Object(S.jsx)(m.b,{userID:this.state.userID})}return Object(S.jsxs)("div",{className:p.a.container,style:{height:0!=this.state.height?this.state.height:"100vh"},children:[Object(S.jsxs)(j.a,{children:[Object(S.jsx)("title",{children:"Driver Application | Perch"}),Object(S.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),Object(S.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon-32x32.png"}),Object(S.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon-16x16.png"}),Object(S.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-touch-icon.png"}),Object(S.jsx)("link",{rel:"manifest",href:"/site.webmanifest"}),Object(S.jsx)("link",{rel:"mask-icon",href:"/safari-pinned-tab.svg",color:"#5bbad5"}),Object(S.jsx)("meta",{name:"theme-color",content:"#ffffff"}),Object(S.jsx)("html",{lang:"en"})]}),Object(S.jsxs)("div",{className:p.a.header,children:[Object(S.jsx)("div",{className:p.a.logoBox,children:Object(S.jsx)("a",{href:"/",children:Object(S.jsx)("div",{className:p.a.logo,children:Object(S.jsx)(f.c,{color:"#FFFFFF"})})})}),Object(S.jsxs)("div",{className:p.a.optionShadowBox,children:[Object(S.jsx)("p",{className:p.a.optionTitle,children:o}),Object(S.jsxs)("div",{className:p.a.textRow1,children:[this.state.firstName?Object(S.jsxs)(S.Fragment,{children:[this.state.url?Object(S.jsx)("img",{src:this.state.url,className:p.a.dp,style:{objectFit:"cover",borderWidth:"0px"}}):Object(S.jsx)("div",{className:p.a.dp}),Object(S.jsx)("p",{className:p.a.text_,children:"Hello, ".concat(this.state.firstName)})]}):Object(S.jsx)(S.Fragment,{}),Object(S.jsx)("a",{className:p.a.link_,href:"/s/articles/how_perch_works",children:Object(S.jsx)("p",{className:p.a.text,children:"How it works"})}),Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:p.a.circle,onClick:function(){y.C.call(t,!0)},children:Object(S.jsx)(b.a,{color:"#FFFFFF",className:p.a.logOut})})})]})]})]}),Object(S.jsxs)("div",{className:p.a.body,children:[Object(S.jsxs)("div",{className:p.a.couple,children:[Object(S.jsxs)("div",{className:p.a.column,children:[Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:"one"==this.state.currentState.stage?p.a.optionIcon_Selected:p.a.optionIcon,id:p.a.optionIcon_,children:Object(S.jsx)("div",{className:p.a.one,children:Object(S.jsx)(f.a,{icon:"one"})})})}),Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:"two"==this.state.currentState.stage?p.a.optionIcon_Selected:p.a.optionIcon,id:p.a.optionIcon_,children:Object(S.jsx)("div",{className:p.a.two,children:Object(S.jsx)(f.a,{icon:"two"})})})}),Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:"three"==this.state.currentState.stage?p.a.optionIcon_Selected:p.a.optionIcon,id:p.a.optionIcon_,children:Object(S.jsx)("div",{className:p.a.three,children:Object(S.jsx)(f.a,{icon:"three"})})})})]}),Object(S.jsxs)("div",{className:p.a.optionList,children:[Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:"one"==this.state.currentState.stage?p.a.optionDescriptionCont_Selected:p.a.optionDescriptionCont,id:p.a.optionDescriptionCont_,children:Object(S.jsx)("p",{className:p.a.optionDescription,children:"Vehicle Confirmation"})})}),Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:"two"==this.state.currentState.stage?p.a.optionDescriptionCont_Selected:p.a.optionDescriptionCont,id:p.a.optionDescriptionCont_,children:Object(S.jsx)("p",{className:p.a.optionDescription,children:"Upload Documents"})})}),Object(S.jsx)("a",{children:Object(S.jsx)("div",{className:"three"==this.state.currentState.stage?p.a.optionDescriptionCont_Selected:p.a.optionDescriptionCont,id:p.a.optionDescriptionCont_,children:Object(S.jsx)("p",{className:p.a.optionDescription,children:"Application Status"})})})]})]}),Object(S.jsx)("div",{className:p.a.content,children:e})]})]})}}]),o}(d.a.Component)},mw2Z:function(t,e,o){t.exports={container:"layout_container__4j1Ab",textRow1:"layout_textRow1__3i_4d",dp:"layout_dp__39qxU",body:"layout_body__dVbfB",couple:"layout_couple__1kNwy",column:"layout_column__2KJEV",column_d:"layout_column_d__1wDt7",optionList:"layout_optionList__2U_e6",content:"layout_content__1g7bu",text:"layout_text__2-bGs",text_:"layout_text___1R1WJ",text_d:"layout_text_d__2B94q",link_:"layout_link___DsGSd",link_d:"layout_link_d__3zdFt",circle:"layout_circle__J0sLg",circle_d:"layout_circle_d__1onJ1",logOut:"layout_logOut__3pMVj",header:"layout_header__h3g50",logo:"layout_logo__17pZ2",logoBox:"layout_logoBox__kxwp_",logoBox_d:"layout_logoBox_d__2xdwq",optionTitle:"layout_optionTitle__uyxw1",optionShadowBox:"layout_optionShadowBox__1Q-Ae",optionIcon:"layout_optionIcon__3m-31",optionIcon_Selected:"layout_optionIcon_Selected__scCvh",optionIcon_d:"layout_optionIcon_d__2-Vja",optionIcon_Selected_d:"layout_optionIcon_Selected_d__2xBHT",optionDescriptionCont:"layout_optionDescriptionCont__3A8yW",optionDescriptionCont_Selected:"layout_optionDescriptionCont_Selected__1i8LD",optionDescriptionCont_:"layout_optionDescriptionCont___CgXvL",optionIcon_:"layout_optionIcon___3y1uu",optionDescription:"layout_optionDescription__2l35V",db:"layout_db__2lWSG",th:"layout_th__39m13",pw:"layout_pw__1dO6s",cu:"layout_cu__mNpeH",ss:"layout_ss__3rlCI",tt:"layout_tt__1dwRg",vh:"layout_vh__tDXSS",md:"layout_md__PTNMa",pi:"layout_pi__iAidU",one:"layout_one__37Fah",two:"layout_two__JWVLW",three:"layout_three__1aTnh"}}},[["HkCf",0,1,6,5,7,9,15,14,21,23,24,22,17,18,16,3,2,4,8,13,19,20]]]);